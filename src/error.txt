Fix size testing.
training chunk_sizes: [10]
The output will be saved to  /home/alina/anaconda3/envs/centernet/CenterNet/src/lib/../../exp/ctdet/coco_dla
heads {'hm': 80, 'wh': 2, 'reg': 2}
Namespace(K=100, aggr_weight=0.0, agnostic_ex=False, arch='dla_34', aug_ddd=0.5, aug_rot=0, batch_size=10, cat_spec_wh=False, center_thresh=0.1, chunk_sizes=[10], data_dir='/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/../../data', dataset='coco', debug=0, debug_dir='/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/../../exp/ctdet/coco_dla/debug', debugger_theme='white', demo='', dense_hp=False, dense_wh=False, dep_weight=1, dim_weight=1, down_ratio=4, eval_oracle_dep=False, eval_oracle_hm=False, eval_oracle_hmhp=False, eval_oracle_hp_offset=False, eval_oracle_kps=False, eval_oracle_offset=False, eval_oracle_wh=False, exp_dir='/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/../../exp/ctdet', exp_id='coco_dla', fix_res=True, flip=0.5, flip_test=False, gpus=[0], gpus_str='0', head_conv=256, heads={'hm': 80, 'wh': 2, 'reg': 2}, hide_data_time=False, hm_hp=True, hm_hp_weight=1, hm_weight=1, hp_weight=1, input_h=512, input_res=512, input_w=512, keep_res=False, kitti_split='3dop', load_model='', lr=0.000125, lr_step=[90, 120], master_batch_size=10, mean=array([[[0.40789655, 0.44719303, 0.47026116]]], dtype=float32), metric='loss', mse_loss=False, nms=False, no_color_aug=False, norm_wh=False, not_cuda_benchmark=False, not_hm_hp=False, not_prefetch_test=False, not_rand_crop=False, not_reg_bbox=False, not_reg_hp_offset=False, not_reg_offset=False, num_classes=80, num_epochs=140, num_iters=-1, num_stacks=1, num_workers=0, off_weight=1, output_h=128, output_res=128, output_w=128, pad=31, peak_thresh=0.2, print_iter=0, rect_mask=False, reg_bbox=True, reg_hp_offset=True, reg_loss='l1', reg_offset=True, resume=False, root_dir='/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/../..', rot_weight=1, rotate=0, save_all=False, save_dir='/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/../../exp/ctdet/coco_dla', scale=0.4, scores_thresh=0.1, seed=317, shift=0.1, std=array([[[0.2886383 , 0.27408165, 0.27809834]]], dtype=float32), task='ctdet', test=False, test_scales=[1.0], trainval=False, val_intervals=5, vis_thresh=0.3, wh_weight=0.1)
Creating model...
Setting up data...
==> initializing coco 2017 val data.
loading annotations into memory...
Done (t=0.37s)
creating index...
index created!
Loaded val 5000 samples
==> initializing coco 2017 train data.
loading annotations into memory...
Done (t=10.18s)
creating index...
index created!
Loaded train 118287 samples
Starting training...
Traceback (most recent call last):
  File "main.py", line 102, in <module>
    main(opt)
  File "main.py", line 70, in main
    log_dict_train, _ = trainer.train(epoch, train_loader)
  File "/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/trains/base_trainer.py", line 119, in train
    return self.run_epoch('train', epoch, data_loader)
  File "/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/trains/base_trainer.py", line 69, in run_epoch
    output, loss, loss_stats = model_with_loss(batch)
  File "/home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/nn/modules/module.py", line 493, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/trains/base_trainer.py", line 19, in forward
    outputs = self.model(batch['input'])
  File "/home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/nn/modules/module.py", line 493, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/pose_dla_dcn.py", line 472, in forward
    x = self.dla_up(x)
  File "/home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/nn/modules/module.py", line 493, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/pose_dla_dcn.py", line 411, in forward
    ida(layers, len(layers) -i - 2, len(layers))
  File "/home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/nn/modules/module.py", line 493, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/pose_dla_dcn.py", line 386, in forward
    layers[i] = node(layers[i] + layers[i - 1])
  File "/home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/nn/modules/module.py", line 493, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/pose_dla_dcn.py", line 355, in forward
    x = self.conv(x)
  File "/home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/nn/modules/module.py", line 493, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/DCNv2/dcn_v2.py", line 128, in forward
    self.deformable_groups)
  File "/home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/DCNv2/dcn_v2.py", line 31, in forward
    ctx.deformable_groups)
RuntimeError: CUDA out of memory. Tried to allocate 180.00 MiB (GPU 0; 3.82 GiB total capacity; 2.60 GiB already allocated; 154.94 MiB free; 143.43 MiB cached) (malloc at ../c10/cuda/CUDACachingAllocator.cpp:267)
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x6d (0x7f418301d33d in /home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x162a9 (0x7f41830462a9 in /home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x18260 (0x7f4183048260 in /home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)
frame #3: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) + 0x4cf (0x7f4189574e0f in /home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/lib/libcaffe2_gpu.so)
frame #4: at::CUDAType::empty(c10::ArrayRef<long>, c10::TensorOptions const&) const + 0xab (0x7f4189b3e90b in /home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/lib/libcaffe2_gpu.so)
frame #5: torch::autograd::VariableType::empty(c10::ArrayRef<long>, c10::TensorOptions const&) const + 0x298 (0x7f418694fbe8 in /home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/lib/libtorch.so.1)
frame #6: <unknown function> + 0x3441e (0x7f41551ff41e in /home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/DCNv2/_ext.cpython-37m-x86_64-linux-gnu.so)
frame #7: dcn_v2_cuda_forward(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::Tensor const&, at::Tensor const&, int, int, int, int, int, int, int, int, int) + 0xab9 (0x7f41551fff85 in /home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/DCNv2/_ext.cpython-37m-x86_64-linux-gnu.so)
frame #8: dcn_v2_forward(at::Tensor const&, at::Tensor const&, at::Tensor const&, at::Tensor const&, at::Tensor const&, int, int, int, int, int, int, int, int, int) + 0x16d (0x7f415521030d in /home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/DCNv2/_ext.cpython-37m-x86_64-linux-gnu.so)
frame #9: <unknown function> + 0x50bd8 (0x7f415521bbd8 in /home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/DCNv2/_ext.cpython-37m-x86_64-linux-gnu.so)
frame #10: <unknown function> + 0x4deda (0x7f4155218eda in /home/alina/anaconda3/envs/centernet/CenterNet/src/lib/models/networks/DCNv2/_ext.cpython-37m-x86_64-linux-gnu.so)
<omitting python frames>
frame #12: python() [0x4ae9f0]
frame #15: THPFunction_apply(_object*, _object*) + 0x7a6 (0x7f41aed93d26 in /home/alina/anaconda3/envs/centernet_2020/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #17: python() [0x4ae9f0]
frame #20: python() [0x4c9a80]
frame #26: python() [0x578b67]
frame #28: python() [0x4aea19]
frame #31: python() [0x4c9a80]
frame #37: python() [0x578b67]
frame #39: python() [0x4aea19]
frame #42: python() [0x4c9a80]
frame #48: python() [0x578b67]
frame #50: python() [0x4aea19]
frame #53: python() [0x4c9a80]
frame #59: python() [0x578b67]
frame #61: python() [0x4aea19]

